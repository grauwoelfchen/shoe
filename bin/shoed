#!/usr/bin/env ruby
# encoding: utf-8

$: << File.expand_path("../src", File.dirname(__FILE__))
$: << File.expand_path("..", File.dirname(__FILE__))

require 'drb/drb'
require 'util/shoeapp'
require 'etc/db_connection'

ODBA.cache.setup
ODBA.cache.clean_prefetched

if (opt = ARGV.first and opt == 'crawler')
  server_uri = SHOE::SERVER_URI_FOR_CRAWLER
  $0 = "Shoe (ShoeApp:Crawler)"
else
  server_uri = SHOE::SERVER_URI
  $0 = "Shoe (ShoeApp)"
end
$shoe = SHOE::App.new({:server_uri => server_uri})
DRb.start_service(server_uri, $shoe)
DRb.thread.join
